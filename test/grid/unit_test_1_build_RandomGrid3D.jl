test_build(RandomGrid3D,
    make_molecular_system(coordinate=Array[[-1., 0., 0.], [1., 0., 0.]]),
    Array[[1.,0.,0.], [0., 1., 0.], [0., 0., 1.]],
    (1., 1., 1.),
    (2,2,2),
    Array[
        Array[AbstractFloat[-0.5535252075389989,-0.5335543689723603,-0.6394760198548614],AbstractFloat[-0.47564189153627956,0.7756451689302043,-0.4148968099793309]],
        Array[AbstractFloat[0.116624811122233,0.4025498161901395,-0.2400040023842402],AbstractFloat[0.1505466502765508,-0.29308564245936297,0.4387821929246831]],
        Array[AbstractFloat[-0.39748013585822883,0.38660944026664457,0.6824672613599314],AbstractFloat[0.9479147166183942,1.0422641578568927,0.31570782533684066]], 
        Array[AbstractFloat[1.185184250098388,0.39346262581321867,0.773187692109815],AbstractFloat[1.9995355388643303,0.978295520298625,0.021392103872348092]],
        Array[AbstractFloat[0.08542974916825341,-0.9697990816851888,0.7715454112528842],AbstractFloat[0.5195656627143135,0.8219317283663047,0.7665910112420354]], 
        Array[AbstractFloat[1.3814552742153259,-0.36857981803538387,0.1522731622094804],AbstractFloat[0.018279654177451365,-4.297547442379951e-5,1.1903290854051582]],
        Array[AbstractFloat[-0.5469406508506439,0.19003294075033417,0.7883179568845717],AbstractFloat[-0.5354318583735473,0.5932263499276644,1.7401674963449008]], 
        Array[AbstractFloat[1.8213312147131857,0.44247589670088006,0.87924442050872],AbstractFloat[1.9400270450332555,1.3296169847695933,0.912240111910696]], 
    ],
    "test 1.1";
    seed=12345
)

test_build(RandomGrid3D,
    make_molecular_system(coordinate=Array[[-1., 0., 0.], [1., 0., 0.]]),
    Array[[1.,0.,0.], [0., 1., 0.], [0., 0., 1.]],
    (1., 1., 1.),
    (2,2,2),
    Array[
        Array[AbstractFloat[-0.5535252075389989,-0.5335543689723603,-0.6394760198548614],AbstractFloat[-0.47564189153627956,0.7756451689302043,-0.4148968099793309]],
        Array[AbstractFloat[0.116624811122233,0.4025498161901395,-0.2400040023842402],AbstractFloat[0.1505466502765508,-0.29308564245936297,0.4387821929246831]],
        Array[AbstractFloat[-0.39748013585822883,0.38660944026664457,0.6824672613599314],AbstractFloat[0.9479147166183942,1.0422641578568927,0.31570782533684066]], 
        Array[AbstractFloat[1.185184250098388,0.39346262581321867,0.773187692109815],AbstractFloat[1.9995355388643303,0.978295520298625,0.021392103872348092]],
        Array[AbstractFloat[0.08542974916825341,-0.9697990816851888,0.7715454112528842],AbstractFloat[0.5195656627143135,0.8219317283663047,0.7665910112420354]], 
        Array[AbstractFloat[1.3814552742153259,-0.36857981803538387,0.1522731622094804],AbstractFloat[0.018279654177451365,-4.297547442379951e-5,1.1903290854051582]],
        Array[AbstractFloat[-0.5469406508506439,0.19003294075033417,0.7883179568845717],AbstractFloat[-0.5354318583735473,0.5932263499276644,1.7401674963449008]], 
        Array[AbstractFloat[1.8213312147131857,0.44247589670088006,0.87924442050872],AbstractFloat[1.9400270450332555,1.3296169847695933,0.912240111910696]], 
    ],
    "test 1.2: same test but test for speed without the compilation time";
    seed=12345
)